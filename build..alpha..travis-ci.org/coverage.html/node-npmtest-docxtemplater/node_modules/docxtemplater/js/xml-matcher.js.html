<!doctype html>
<html lang="en">
<head>
    <title>Code coverage report for node-npmtest-docxtemplater/node_modules/docxtemplater/js/xml-matcher.js</title>
    <meta charset="utf-8">
    <style>
        body, html {
            margin:0; padding: 0;
        }
        body {
            font-family: Arial, Helvetica;
            font-size: 10pt;
        }
        div.header, div.footer {
            background: #eee;
            padding: 1em;
        }
        div.header {
            height: 160px;
            padding: 0 1em 0 1em;
            z-index: 100;
            position: fixed;
            top: 0;
            border-bottom: 1px solid #666;
            width: 100%;
        }
        div.footer {
            border-top: 1px solid #666;
        }
        div.body {
            margin-top: 170px;
        }
        div.meta {
            font-size: 90%;
            text-align: center;
        }
        h1, h2, h3 {
            font-weight: normal;
        }
        h1 {
            font-size: 12pt;
        }
        h2 {
            font-size: 10pt;
        }
        pre {
            font-family: Menlo, Monaco, Consolas, Courier New, monospace;
            margin: 0;
            padding: 0;
            font-size: 14px;
            tab-size: 2;
        }

        div.path { font-size: 110%; }
        div.path a:link, div.path a:visited { color: #000; }
        table.coverage { border-collapse: collapse; margin:0; padding: 0 }

        table.coverage td {
            margin: 0;
            padding: 0;
            color: #111;
            vertical-align: top;
        }
        table.coverage td.line-count {
            width: 50px;
            text-align: right;
            padding-right: 5px;
        }
        table.coverage td.line-coverage {
            color: #777 !important;
            text-align: right;
            border-left: 1px solid #666;
            border-right: 1px solid #666;
        }

        table.coverage td.text {
        }

        table.coverage td span.cline-any {
            display: inline-block;
            padding: 0 5px;
            width: 40px;
        }
        table.coverage td span.cline-neutral {
            background: #eee;
        }
        table.coverage td span.cline-yes {
            background: #b5d592;
            color: #999;
        }
        table.coverage td span.cline-no {
            background: #fc8c84;
        }

        .cstat-yes { color: #111; }
        .cstat-no { background: #fc8c84; color: #111; }
        .fstat-no { background: #ffc520; color: #111 !important; }
        .cbranch-no { background:  yellow !important; color: #111; }

        .cstat-skip { background: #ddd; color: #111; }
        .fstat-skip { background: #ddd; color: #111 !important; }
        .cbranch-skip { background: #ddd !important; color: #111; }

        .missing-if-branch {
            display: inline-block;
            margin-right: 10px;
            position: relative;
            padding: 0 4px;
            background: black;
            color: yellow;
        }

        .skip-if-branch {
            display: none;
            margin-right: 10px;
            position: relative;
            padding: 0 4px;
            background: #ccc;
            color: white;
        }

        .missing-if-branch .typ, .skip-if-branch .typ {
            color: inherit !important;
        }

        .entity, .metric { font-weight: bold; }
        .metric { display: inline-block; border: 1px solid #333; padding: 0.3em; background: white; }
        .metric small { font-size: 80%; font-weight: normal; color: #666; }

        div.coverage-summary table { border-collapse: collapse; margin: 3em; font-size: 110%; }
        div.coverage-summary td, div.coverage-summary table  th { margin: 0; padding: 0.25em 1em; border-top: 1px solid #666; border-bottom: 1px solid #666; }
        div.coverage-summary th { text-align: left; border: 1px solid #666; background: #eee; font-weight: normal; }
        div.coverage-summary th.file { border-right: none !important; }
        div.coverage-summary th.pic { border-left: none !important; text-align: right; }
        div.coverage-summary th.pct { border-right: none !important; }
        div.coverage-summary th.abs { border-left: none !important; text-align: right; }
        div.coverage-summary td.pct { text-align: right; border-left: 1px solid #666; }
        div.coverage-summary td.abs { text-align: right; font-size: 90%; color: #444; border-right: 1px solid #666; }
        div.coverage-summary td.file { text-align: right; border-left: 1px solid #666; white-space: nowrap;  }
        div.coverage-summary td.pic { min-width: 120px !important;  }
        div.coverage-summary a:link { color: #000; }
        div.coverage-summary a:visited { color: #333; }
        div.coverage-summary tfoot td { border-top: 1px solid #666; }

        div.coverage-summary .yui3-datatable-sort-indicator, div.coverage-summary .dummy-sort-indicator {
            height: 10px;
            width: 7px;
            display: inline-block;
            margin-left: 0.5em;
        }
        div.coverage-summary .yui3-datatable-sort-indicator {
            background: no-repeat scroll 0 0 transparent;
        }
        div.coverage-summary .yui3-datatable-sorted .yui3-datatable-sort-indicator {
            background-position: 0 -20px;
        }
        div.coverage-summary .yui3-datatable-sorted-desc .yui3-datatable-sort-indicator {
            background-position: 0 -10px;
        }

        .high { background: #b5d592 !important; }
        .medium { background: #ffe87c !important; }
        .low { background: #fc8c84 !important; }

        span.cover-fill, span.cover-empty {
            display:inline-block;
            border:1px solid #444;
            background: white;
            height: 12px;
        }
        span.cover-fill {
            background: #ccc;
            border-right: 1px solid #444;
        }
        span.cover-empty {
            background: white;
            border-left: none;
        }
        span.cover-full {
            border-right: none !important;
        }
        pre.prettyprint {
            border: none !important;
            padding: 0 !important;
            margin: 0 !important;
        }
        .com { color: #999 !important; }
        .ignore-none { color: #999; font-weight: normal; }

    </style>
</head>
<body>
<div class="header low">
    <h1 style="font-weight: bold;">
        <a href="https://github.com/npmtest/node-npmtest-docxtemplater">npmtest-docxtemplater (v0.0.2)</a>
    </h1>
    <h1>Code coverage report for <span class="entity">node-npmtest-docxtemplater/node_modules/docxtemplater/js/xml-matcher.js</span></h1>
    <h2>
        
        Statements: <span class="metric">17.39% <small>(8 / 46)</small></span> &nbsp;&nbsp;&nbsp;&nbsp;
        
        
        Branches: <span class="metric">0% <small>(0 / 4)</small></span> &nbsp;&nbsp;&nbsp;&nbsp;
        
        
        Functions: <span class="metric">0% <small>(0 / 7)</small></span> &nbsp;&nbsp;&nbsp;&nbsp;
        
        
        Lines: <span class="metric">17.39% <small>(8 / 46)</small></span> &nbsp;&nbsp;&nbsp;&nbsp;
        
        Ignored: <span class="metric"><span class="ignore-none">none</span></span> &nbsp;&nbsp;&nbsp;&nbsp;
    </h2>
    <div class="path"><a href="../../../../index.html">All files</a> &#187; <a href="index.html">node-npmtest-docxtemplater/node_modules/docxtemplater/js/</a> &#187; xml-matcher.js</div>
</div>
<div class="body">
<pre><table class="coverage">
<tr><td class="line-count">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
53
54
55
56
57
58
59
60
61
62
63
64
65
66
67
68
69
70
71
72
73
74
75
76
77
78</td><td class="line-coverage"><span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span></td><td class="text"><pre class="prettyprint lang-js">"use strict";
// res class responsibility is to parse the XML.
&nbsp;
var DocUtils = require("./doc-utils");
var memoize = require("./memoize");
&nbsp;
<span class="fstat-no" title="function not covered" >function handleRecursiveCase(res) {</span>
	/*
 	 Because xmlTemplater is recursive (meaning it can call it self), we need to handle special cases where the XML is not valid:
 	 For example with res string "I am&lt;/w:t&gt;&lt;/w:r&gt;&lt;/w:p&gt;&lt;w:p&gt;&lt;w:r&gt;&lt;w:t&gt;sleeping",
 	 - we need to match also the string that is inside an implicit &lt;w:t&gt; (that's the role of replacerUnshift) (in res case 'I am')
 	 - we need to match the string that is at the right of a &lt;w:t&gt; (that's the role of replacerPush) (in res case 'sleeping')
 	 the test: describe "scope calculation" it "should compute the scope between 2 &lt;w:t&gt;" makes sure that res part of code works
 	 It should even work if they is no XML at all, for example if the code is just "I am sleeping", in res case however, they should only be one match
 	 */
&nbsp;
<span class="fstat-no" title="function not covered" >	function replacerUnshift() {</span>
<span class="cstat-no" title="statement not covered" >		var pn = { array: Array.prototype.slice.call(arguments) };</span>
<span class="cstat-no" title="statement not covered" >		pn.array.shift();</span>
<span class="cstat-no" title="statement not covered" >		var match = pn.array[0] + pn.array[1];</span>
		// add match so that pn[0] = whole match, pn[1]= first parenthesis,...
<span class="cstat-no" title="statement not covered" >		pn.array.unshift(match);</span>
<span class="cstat-no" title="statement not covered" >		pn.array.pop();</span>
<span class="cstat-no" title="statement not covered" >		var offset = pn.array.pop();</span>
<span class="cstat-no" title="statement not covered" >		pn.offset = offset;</span>
<span class="cstat-no" title="statement not covered" >		pn.first = true;</span>
		// add at the beginning
<span class="cstat-no" title="statement not covered" >		res.matches.unshift(pn);</span>
<span class="cstat-no" title="statement not covered" >		res.charactersAdded.unshift(0);</span>
<span class="cstat-no" title="statement not covered" >		return res.charactersAddedCumulative.unshift(0);</span>
	}
&nbsp;
<span class="cstat-no" title="statement not covered" >	if (res.content.indexOf("&lt;") === -1 &amp;&amp; res.content.indexOf("&gt;") === -1) {</span>
<span class="cstat-no" title="statement not covered" >		res.content.replace(/^()([^&lt;&gt;]*)$/, replacerUnshift);</span>
	}
&nbsp;
<span class="cstat-no" title="statement not covered" >	var r = new RegExp("^()([^&lt;]+)&lt;/(?:" + res.tagsXmlArrayJoined + ")&gt;");</span>
<span class="cstat-no" title="statement not covered" >	res.content.replace(r, replacerUnshift);</span>
&nbsp;
<span class="fstat-no" title="function not covered" >	function replacerPush() {</span>
<span class="cstat-no" title="statement not covered" >		var pn = { array: Array.prototype.slice.call(arguments) };</span>
<span class="cstat-no" title="statement not covered" >		pn.array.pop();</span>
<span class="cstat-no" title="statement not covered" >		var offset = pn.array.pop();</span>
<span class="cstat-no" title="statement not covered" >		pn.offset = offset;</span>
<span class="cstat-no" title="statement not covered" >		pn.last = true;</span>
		// add at the end
<span class="cstat-no" title="statement not covered" >		res.matches.push(pn);</span>
<span class="cstat-no" title="statement not covered" >		res.charactersAdded.push(0);</span>
<span class="cstat-no" title="statement not covered" >		return res.charactersAddedCumulative.push(0);</span>
	}
&nbsp;
<span class="cstat-no" title="statement not covered" >	r = new RegExp("(&lt;(?:" + res.tagsXmlArrayJoined + ")[^&gt;]*&gt;)([^&gt;]+)$");</span>
<span class="cstat-no" title="statement not covered" >	res.content.replace(r, replacerPush);</span>
<span class="cstat-no" title="statement not covered" >	return res;</span>
}
&nbsp;
<span class="fstat-no" title="function not covered" >function xmlMatcher(content, tagsXmlArray) {</span>
<span class="cstat-no" title="statement not covered" >	var res = {};</span>
<span class="cstat-no" title="statement not covered" >	res.content = content;</span>
<span class="cstat-no" title="statement not covered" >	res.tagsXmlArray = tagsXmlArray;</span>
<span class="cstat-no" title="statement not covered" >	res.tagsXmlArrayJoined = res.tagsXmlArray.join("|");</span>
<span class="cstat-no" title="statement not covered" >	var regexp = new RegExp("(&lt;(?:" + res.tagsXmlArrayJoined + ")[^&gt;]*&gt;)([^&lt;&gt;]*)&lt;/(?:" + res.tagsXmlArrayJoined + ")&gt;", "g");</span>
<span class="cstat-no" title="statement not covered" >	res.matches = DocUtils.pregMatchAll(regexp, res.content);</span>
<span class="cstat-no" title="statement not covered" >	res.charactersAddedCumulative = res.matches.map(<span class="fstat-no" title="function not covered" >function () {</span></span>
<span class="cstat-no" title="statement not covered" >		return 0;</span>
	});
<span class="cstat-no" title="statement not covered" >	res.charactersAdded = res.matches.map(<span class="fstat-no" title="function not covered" >function () {</span></span>
<span class="cstat-no" title="statement not covered" >		return 0;</span>
	});
<span class="cstat-no" title="statement not covered" >	return handleRecursiveCase(res);</span>
}
&nbsp;
var memoized = memoize(xmlMatcher);
&nbsp;
module.exports = <span class="fstat-no" title="function not covered" >function (content, tagsXmlArray) {</span>
<span class="cstat-no" title="statement not covered" >	return DocUtils.cloneDeep(memoized(content, tagsXmlArray));</span>
};
&nbsp;</pre></td></tr>
</table></pre>
</div>
<div class="footer">
    <div class="meta">Generated by <a href="https://github.com/kaizhu256/node-utility2" target="_blank">utility2</a> at Thu Apr 20 2017 01:12:34 GMT+0000 (UTC)</div>
</div>
</body>
</html>
